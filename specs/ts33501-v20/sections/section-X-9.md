# X.9	Authorization of selection of participant NWDAF instances in the Federated Learning group

The authorization for selecting participant NWDAF instances in the Federated Learning (FL) group uses token-based authorization as specified in clause 13.4.1, with the following additions.
Figure X.9-1 depicts the authorization mechanism for NWDAF containing MTLF acting as FL Server to initiate the Federated Learning process on the NWDAF containing MTLF(s) acting as FL Client(s). The authorization is based upon the FL capability type (FL server and/or FL client) and Vendor ID provided by the NWDAF containing MTLF acting as FL server during registration, and the Analytics ID and Interoperability Indicator per Analytics ID provided by the NWDAF containing MTLF acting as FL client during registration.
NOTE: 	Federated Learning can be initiated by an NWDAF containing AnLF, or an NWDAF containing MTLF on behalf of an NWDAF containing AnLF, requesting ML models from an NWDAF containing MTLF acting as FL Server, as described in clause 5.3 of TS 23.288 [105]. Authorization of this procedure is described in Annex X.10.
Figure X.9-1: FL Authorization for selecting participant NWDAF instances
Step 1a. The NWDAF containing MTLF acting as FL client registers to the NRF with its FL related information, including Vendor ID, supported FL capability (FL client), Analytics ID(s) and Interoperability Indicator per Analytics ID as described in clause 5.2 of TS 23.288.
Step 1b. The NWDAF containing MTLF acting as FL server registers to the NRF with its Vendor ID, FL capability (FL Server).
Step 2. The NWDAF containing MTLF acting as FL server (NF Service Consumer) sends a discovery request to NRF and receives the available NWDAFs containing MTLF acting as FL client(s) (NF Service Producer) as a response, as specified in clause 6.2C.2.1 of TS 23.288 [105].
Step 3. The NWDAF containing MTLF acting as FL server (NF Service Consumer) sends an access token request to the NRF as specified in clause 13.4.1. The access token request may contain the Analytics ID for the requested Federated Learning process.
Step 4. The NRF authorizes the NWDAF containing MTLF acting as FL server (NF Consumer) based upon the information received in Step 1b, and after verifying that the Server NWDAFâ€™s Vendor ID is included in the Interoperability Indicator for the requested Analytics ID provided in Step 1a. If the authorization succeeds, NRF generates the access token(s) as specified in clause 13.4.1. The access token claims may include the Analytics ID for the request Federated Learning process.
NOTE: Fine-grained authorization can be done locally at the NWDAFs containing MTLF acting as FL client(s) (NF Service Producer).
Step 5a, 5b. The NRF sends the access token to the NWDAF containing MTLF acting as FL Server, or rejects the request in case of failed authorization, as described in clause 13.4.1.
Step 6. The NWDAF containing MTLF acting as FL server sends the service request to the NWDAF(s) containing MTLF acting as FL client with the access token received in Step 5a. along with the Analytics ID information for which the FL process is to be performed, as described in TS 23.288 [105].
Step 7, 8. The NWDAF containing MTLF acting as FL client (NF Service Producer) verifies the received access token as specified in clause 13.4.1. In case of successful access token verification, the NWDAF containing MTLF acting as FL client sends a success response to the NWDAF containing MTLF acting as FL server, as described in TS 23.288 [105].
Step 9. After a successful response from the NWDAF(s) containing MTLF acting as FL client, the NWDAF containing MTLF acting as FL server initiates the Federated Learning process as described in TS 23.288 [105].
Authorization of the NWDAF containing MTLF acting as FL client and receiving global model information from NWDAF containing MTLF acting as FL server is implicit, since it can join a Federated Learning group only when selected by the NWDAF containing MTLF acting as FL server.
