# 

3GPP TS 33.501 V20.0.0 (2026-01)
Technical Specification
3rd Generation Partnership Project;
Technical Specification Group Services and System Aspects;
Security architecture and procedures for 5G system
(Release 20)
The present document has been developed within the 3rd Generation Partnership Project (3GPP TM) and may be further elaborated for the purposes of 3GPP..
The present document has not been subject to any approval process by the 3GPP Organizational Partners and shall not be implemented.
This Specification is provided for future development work within 3GPP only. The Organizational Partners accept no liability for any use of this Specification.
Specifications and Reports for implementation of the 3GPP TM system should be obtained via the 3GPP Organizational Partners' Publications Offices.
Keywords
security,5G
3GPP
Postal address
3GPP support office address
650 Route des Lucioles – Sophia Antipolis
Valbonne – France
Tel.: +33 4 92 94 42 00 Fax: +33 4 93 65 47 16
Internet
http://www.3gpp.org
Copyright Notification
No part may be reproduced except as authorized by written permission.
The copyright and the foregoing restriction extend to reproduction in all media.
© 2026, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC).
All rights reserved.
UMTS™ is a Trade Mark of ETSI registered for the benefit of its members
3GPP™ is a Trade Mark of ETSI registered for the benefit of its Members and of the 3GPP Organizational Partners
LTE™ is a Trade Mark of ETSI registered for the benefit of its Members and of the 3GPP Organizational Partners
GSM® and the GSM logo are registered and owned by the GSM Association
Contents
Foreword	19
1	Scope	20
2	References	20
3	Definitions and abbreviations	24
3.1	Definitions	24
3.2	Abbreviations	28
4	Overview of security architecture	31
4.1	Security domains	31
4.2	Security at the perimeter of the 5G Core network	32
4.2.0	General	32
4.2.1	Security Edge Protection Proxy (SEPP)	32
4.2.2	Inter-PLMN UP Security (IPUPS)	32
4.3	Security entities in the 5G Core network	32
5	Security requirements and features	32
5.1	General security requirements	32
5.1.1	Mitigation of bidding down attacks	32
5.1.2	Authentication and Authorization	33
5.1.3	Requirements on 5GC and NG-RAN related to keys	33
5.2	Requirements on the UE	33
5.2.1	General	33
5.2.2	User data and signalling data confidentiality	33
5.2.3	User data and signalling data integrity	34
5.2.4	Secure storage and processing of subscription credentials	34
5.2.5	Subscriber privacy	35
5.3	Requirements on the gNB	35
5.3.1	General	35
5.3.2	User data and signalling data confidentiality	36
5.3.3	User data and signalling data integrity	36
5.3.4	Requirements for the gNB setup and configuration	36
5.3.5	Requirements for key management inside the gNB	37
5.3.6	Requirements for handling user plane data for the gNB	37
5.3.7	Requirements for handling control plane data for the gNB	37
5.3.8	Requirements for secure environment of the gNB	37
5.3.9	Requirements for the gNB F1 interfaces	37
5.3.10	Requirements for the gNB E1 interfaces	38
5.4	Requirements on the ng-eNB	38
5.5	Requirements on the AMF	38
5.5.1	Signalling data confidentiality	38
5.5.2	Signalling data integrity	38
5.5.3	Subscriber privacy	39
5.6	Requirements on the SEAF	39
5.7	Void	39
5.8	Requirements on the UDM	39
5.8.1	Generic requirements	39
5.8.2	Subscriber privacy related requirements to UDM and SIDF	39
5.8a	Requirements on AUSF	39
5.8b	Requirements on the UDR	40
5.9	Core network security	40
5.9.1	Trust boundaries	40
5.9.2	Requirements on service-based architecture	40
5.9.2.1	Security Requirements for service registration, discovery and authorization	40
5.9.2.2	NRF security requirements	40
5.9.2.3	NEF security requirements	41
5.9.2.4	Requirements on the Service Communication Proxy (SCP)	41
5.9.3	Requirements for e2e core network interconnection security	41
5.9.3.1	General	41
5.9.3.2	Requirements for Security Edge Protection Proxy (SEPP)	42
5.9.3.2a	Support for Messages generated by Roaming Intermediaries	44
5.9.3.3	Protection of attributes	44
5.9.3.4	Requirements for IPUPS functionality	45
5.9.3.5	Requirements for Network Functions (NF)	45
5.9.4	Requirements for monitoring 5GC signaling traffic	45
5.9.4.1	Security requirements for the configuration of signalling monitoring	45
5.9.4.2	Security requirements for the streaming of signalling monitoring data	45
5.10	Visibility and configurability	46
5.10.1	Security visibility	46
5.10.2	Security configurability	46
5.11	Requirements for algorithms, and algorithm selection	46
5.11.1	Algorithm identifier values	46
5.11.1.1	Ciphering algorithm identifier values	46
5.11.1.2	Integrity algorithm identifier values	46
5.11.2	Requirements for algorithm selection	47
5.12	Requirements on 5G-RG	47
5.13	Requirements on NSSAAF	47
6	Security procedures between UE and 5G network functions	48
6.0	General	48
6.1	Primary authentication and key agreement	48
6.1.1	Authentication framework	48
6.1.1.1	General	48
6.1.1.2	EAP framework	49
6.1.1.3	Granularity of anchor key binding to serving network	49
6.1.1.4	Construction of the serving network name	49
6.1.1.4.1	Serving network name	49
6.1.1.4.2	Construction of the serving network name by the UE	50
6.1.1.4.3	Construction of the serving network name by the SEAF	50
6.1.2	Initiation of authentication and selection of authentication method	50
6.1.3	Authentication procedures	52
6.1.3.1	Authentication procedure for EAP-AKA'	52
6.1.3.2	Authentication procedure for 5G AKA	54
6.1.3.2.0	5G AKA	54
6.1.3.2.1	Void	57
6.1.3.2.2	RES* verification failure in SEAF or AUSF or both	57
6.1.3.3	Synchronization failure or MAC failure	57
6.1.3.3.1	Synchronization failure or MAC failure in USIM	57
6.1.3.3.2	Synchronization failure recovery in Home Network	57
6.1.4	Linking increased home control to subsequent procedures	58
6.1.4.1	Introduction	58
6.1.4.1a	Linking authentication confirmation to Nudm_UECM_Registration procedure from AMF	58
6.1.4.2	Guidance on linking authentication confirmation to Nudm_UECM_Registration procedure from AMF	59
6.1.5	Home network triggered primary authentication procedure	60
6.1.5.1	General	60
6.1.5.2	Security mechanisms	60
6.2	Key hierarchy, key derivation, and distribution scheme	62
6.2.1	Key hierarchy	62
6.2.2	Key derivation and distribution scheme	63
6.2.2.1	Keys in network entities	63
6.2.2.2	Keys in the UE	65
6.2.3	Handling of user-related keys	67
6.2.3.1	Key setting	67
6.2.3.2	Key identification	67
6.2.3.3	Key lifetimes	68
6.3	Security contexts	69
6.3.1	Distribution of security contexts	69
6.3.1.1	General	69
6.3.1.2	Distribution of subscriber identities and security data within one 5G serving network domain	69
6.3.1.3	Distribution of subscriber identities and security data between 5G serving network domains	69
6.3.1.4	Distribution of subscriber identities and security data between 5G and EPS serving network domains	69
6.3.2	Multiple registrations in same or different serving networks	70
6.3.2.0	General	70
6.3.2.1	Multiple registrations in different PLMNs	70
6.3.2.2	Multiple registrations in the same PLMN	70
6.4	NAS security mechanisms	71
6.4.1	General	71
6.4.2	Security for multiple NAS connections	71
6.4.2.1	Multiple active NAS connections with different PLMNs	71
6.4.2.2	Multiple active NAS connections in the same PLMN's serving network	71
6.4.3	NAS integrity mechanisms	72
6.4.3.0	General	72
6.4.3.1	NAS input parameters to integrity algorithm	72
6.4.3.2	NAS integrity activation	73
6.4.3.3	NAS integrity failure handling	73
6.4.4	NAS confidentiality mechanisms	73
6.4.4.0	General	73
6.4.4.1	NAS input parameters to confidentiality algorithm	73
6.4.4.2	NAS confidentiality activation	73
6.4.5	Handling of NAS COUNTs	74
6.4.6	Protection of initial NAS message	74
6.4.7	Security aspects of SMS over NAS	75
6.5	RRC security mechanisms	75
6.5.1	RRC integrity mechanisms	75
6.5.2	RRC confidentiality mechanisms	76
6.5.3	RRC UE capability transfer procedure	76
6.6	UP security mechanisms	76
6.6.1	UP security policy	76
6.6.2	UP security activation mechanism	77
6.6.3	UP confidentiality mechanisms	79
6.6.4	UP integrity mechanisms	79
6.6.4.1	General	79
6.6.4.2	UP integrity mechanisms between the UE and the gNB	79
6.6.4.3	UP integrity mechanisms between the UE and the ng-eNB	79
6.7	Security algorithm selection, key establishment and security mode command procedure	80
6.7.1	Procedures for NAS algorithm selection	80
6.7.1.1	Initial NAS security context establishment	80
6.7.1.2	AMF change	80
6.7.2	NAS security mode command procedure	80
6.7.3	Procedures for AS algorithm selection	82
6.7.3.0	Initial AS security context establishment	82
6.7.3.1	Xn-handover	82
6.7.3.2	N2-handover	82
6.7.3.3	Intra-gNB-CU handover/intra-ng-eNB handover	83
6.7.3.4	Transitions from RRC_INACTIVE to RRC_CONNECTED states	83
6.7.3.5	RNA Update procedure	83
6.7.3.6	Algorithm negotiation for unauthenticated UEs in LSM	83
6.7.4	AS security mode command procedure	84
6.8	Security handling in state transitions	85
6.8.1	Key handling at connection and registration state transitions	85
6.8.1.1	Key handling at transitions between RM-DEREGISTERED and RM-REGISTERED states	85
6.8.1.1.0	General	85
6.8.1.1.1	Transition from RM-REGISTERED to RM-DEREGISTERED	85
6.8.1.1.2	Transition from RM-DEREGISTERED to RM-REGISTERED	86
6.8.1.1.2.1	General	86
6.8.1.1.2.2	Full native 5G NAS security context available	87
6.8.1.1.2.3	Full native 5G NAS security context not available	87
6.8.1.1.2.4	UE registration over a second access type to the same AMF	88
6.8.1.2	Key handling at transitions between CM-IDLE and CM-CONNECTED states	88
6.8.1.2.0	General	88
6.8.1.2.1	Transition from CM-IDLE to CM-CONNECTED	88
6.8.1.2.2	Establishment of keys for cryptographically protected radio bearers in 3GPP access	89
6.8.1.2.3	Establishment of keys for cryptographically protected traffic in non-3GPP access	89
6.8.1.2.4	Transition from CM-CONNECTED to CM-IDLE	90
6.8.1.3	Key handling for the Registration procedure when registered in NG-RAN	90
6.8.2	Security handling at RRC state transitions	91
6.8.2.1	Security handling at transitions between RRC_INACTIVE and RRC_CONNECTED states	91
6.8.2.1.1	General	91
6.8.2.1.2	State transition from RRC_CONNECTED to RRC_INACTIVE	91
6.8.2.1.3	State transition from RRC_INACTIVE to RRC_CONNECTED to a new gNB/ng-eNB	91
6.8.2.1.4	State transition from RRC_INACTIVE to RRC_CONNECTED to the same gNB/ng-eNB	93
6.8.2.2	Key handling during mobility in RRC_INACTIVE state	93
6.8.2.2.1	General	93
6.8.2.2.2	RAN-based notification area update to a new gNB/ng-eNB	93
6.8.2.2.3	RAN-based notification area update to the same gNB/ng-eNB	93
6.9	Security handling in mobility	94
6.9.1	Void	94
6.9.2	Key handling in handover	94
6.9.2.1	General	94
6.9.2.1.1	Access stratum	94
6.9.2.1.2	Non access stratum	95
6.9.2.2	Key derivations for context modification procedure	95
6.9.2.3	Key derivations during handover	96
6.9.2.3.1	Intra-gNB-CU handover and intra-ng-eNB handover	96
6.9.2.3.2	Xn-handover	96
6.9.2.3.3	N2-Handover	97
6.9.2.3.4	UE handling	98
6.9.3	Key handling in mobility registration update	99
6.9.4	Key-change-on-the-fly	101
6.9.4.1	General	101
6.9.4.2	NAS key re-keying	101
6.9.4.3	NAS key refresh	101
6.9.4.4	AS key re-keying	102
6.9.4.5	AS key refresh	102
6.9.5	Rules on concurrent running of security procedures	103
6.9.5.1	Rules related to AS and NAS security context synchronization	103
6.9.5.2	Rules related to parallel NAS connections	103
6.9.6	Security handling in registration with AMF reallocation via direct NAS reroute	103
6.10	Dual connectivity	104
6.10.1	Introduction	104
6.10.1.1	General	104
6.10.1.2	Dual Connectivity protocol architecture for MR-DC with 5GC	104
6.10.2	Security mechanisms and procedures for DC	105
6.10.2.1	SN Addition or modification	105
6.10.2.2	Secondary Node key update	107
6.10.2.2.1	General	107
6.10.2.2.2	MN initiated	107
6.10.2.2.3	SN initiated	107
6.10.2.3	SN release and change	107
6.10.2.4	Security mechanism and procedures for SCPAC	107
6.10.2.4.1	General	107
6.10.2.4.2	Security context initialization for selective SCPAC	108
6.10.2.4.3	Security mechanism for UE to access target PSCell or SN	108
6.10.2.4.4	Security procedure for UE to access target PSCell or SN	108
6.10.3	Establishing the security context between the UE and SN	110
6.10.3.1	SN Counter maintenance	110
6.10.3.2	Derivation of keys	111
6.10.3.3	Negotiation of security algorithms	111
6.10.4	Protection of traffic between UE and SN	111
6.10.5	Handover Procedure	112
6.10.6	Signalling procedure for PDCP COUNT check	113
6.10.7	Radio link failure recovery	113
6.11	Security handling for RRC connection re-establishment procedure	113
6.12	Subscription identifier privacy	114
6.12.1	Subscription permanent identifier	114
6.12.2	Subscription concealed identifier	115
6.12.3	Subscription temporary identifier	116
6.12.4	Subscription identification procedure	117
6.12.5	Subscription identifier de-concealing function (SIDF)	117
6.13	Signalling procedure for PDCP COUNT check	118
6.14	Steering of roaming security mechanism	118
6.14.1	General	118
6.14.2	Security mechanisms	119
6.14.2.1	Procedure for steering of UE in VPLMN during registration	119
6.14.2.2	Procedure for steering of UE in VPLMN or HPLMN after registration	121
6.14.2.3	SoR Counter	122
6.15	UE parameters update via UDM control plane procedure security mechanism	123
6.15.1	General	123
6.15.2	Security mechanisms	123
6.15.2.1	Procedure for UE Parameters Update	123
6.15.2.2	UE Parameters Update Counter	125
6.16	Security handling in Cellular IoT	125
6.16.1	Security handling in Control Plane CIoT 5GS Optimization	125
6.16.1.1	Security procedures for Small Data Transfer in Control Plane CIoT 5GS Optimisation	125
6.16.1.2	Security procedures for RRCConnectionRe-establishment Procedure in Control Plane CIoT 5GS Optimization	126
6.16.2.1	General	126
6.16.2.2	Connection Suspend	126
6.16.2.3	Connection Resume in CM-IDLE with Suspend to a new ng-eNB	127
6.16.2.4	Connection Resume in CM-IDLE with Suspend to the same ng-eNB	128
6.16.3	Protection of Non-IP Data Delivery (NIDD) interfaces	129
6.16.4	Security handling in NAS based redirection from 5GS to EPS	129
6.17	Security mechanism and procedures for L1/L2 Triggered Mobility	129
6.17.1	When DC is not configured	129
6.17.2	When DC is configured	130
7	Security for non-3GPP access to the 5G core network	130
7.1	General	130
7.1a	Determining trust relationship in the UE	131
7.2	Security procedures	131
7.2.1	Authentication for Untrusted non-3GPP Access	131
7A	Security for trusted non-3GPP access to the 5G core network	135
7A.1	General	135
7A.2	Security procedures	135
7A.2.1	Authentication for trusted non-3GPP access	135
7A.2.1.1	General	135
7A.2.1.2	Re-authentication for UE moving from one TNAP to another TNAP connecting to the same TNGF	138
7A.2.2	Void	138
7A.2.3	Key hierarchy for trusted non-3GPP access	138
7A.2.4	Authentication for devices that do not support 5GC NAS over WLAN access	139
7A.2.4.1	General	139
7A.2.4.2	Re-authentication for UE moving from one TNAP to another TNAP connecting to the same TWIF	142
7B	Security for wireline access to the 5G core network	142
7B.1	General	142
7B.2	Authentication for 5G-RG	142
7B.3	Authentication for FN-RG	144
7B.4	Authentication for UE behind 5G-RG and FN-RG	146
7B.5	Subscriber privacy for wireline access	146
7B.6	Subscriber privacy for N5CW over trusted WLAN access	146
7B.7	Authentication for AUN3 devices behind 5G-RG	146
7B.7.1	General	146
7B.7.2	Authentication for AUN3 devices not supporting 5G key hierarchy	147
7B.7.3	Authentication for AUN3 devices supporting 5G key hierarchy	148
8	Security of interworking	150
8.1	General	150
8.2	Registration procedure for mobility from EPS to 5GS over N26	150
8.3	Handover procedure from 5GS to EPS over N26	151
8.3.1	General	151
8.3.2	Procedure	151
8.4	Handover from EPS to 5GS over N26	154
8.4.1	General	154
8.4.2	Procedure	155
8.5	Idle mode mobility from 5GS to EPS over N26	157
8.5.1	General	157
8.5.2	TAU Procedure	158
8.6	Mapping of security contexts	159
8.6.1	Mapping of a 5G security context to an EPS security context	159
8.6.2	Mapping of an EPS security context to a 5G security context	159
8.7	Interworking without N26 interface in single-registration mode	160
9	Security procedures for non-service based interfaces	160
9.1	General	160
9.1.1	Use of NDS/IP	160
9.1.2	Implementation requirements	160
9.1.3	QoS considerations	160
9.2	Security mechanisms for the N2 interface	161
9.3	Security requirements and procedures on N3	161
9.4	Security mechanisms for the Xn interface	161
9.5	Interfaces based on DIAMETER or GTP	162
9.5.1	Void	162
9.6	Void	162
9.7	Void	162
9.8	Security mechanisms for protection of the gNB internal interfaces	162
9.8.1	General	162
9.8.2	Security mechanisms for the F1 interface	162
9.8.3	Security mechanisms for the E1 interface	163
9.9	Security mechanisms for non-SBA interfaces internal to the 5GC and between PLMNs	163
9.10	Security mechanisms for the interface between W-5GAN and 5GC	164
10	Security aspects of IMS emergency session handling	164
10.1	General	164
10.2	Security procedures and their applicability	164
10.2.1	Authenticated IMS Emergency Sessions	164
10.2.1.1	General	164
10.2.1.2	UE in RM-DEREGISTERED state requests a PDU Session for IMS Emergency services	165
10.2.1.3	UE in RM-REGISTERED state requests a PDU Session for IMS Emergency services	165
10.2.2	Unauthenticated IMS Emergency Sessions	166
10.2.2.1	General	166
10.2.2.2	UE sets up an IMS Emergency session with emergency registration	166
10.2.2.3	Key generation for Unauthenticated IMS Emergency Sessions	167
10.2.2.3.1	General	167
10.2.2.3.2	Handover	168
11	Security procedures between UE and external data networks via the 5G Network	168
11.1	EAP based secondary authentication by an external DN-AAA server	168
11.1.1	General	168
11.1.2	Authentication	169
11.1.3	Re-Authentication	172
11.1.4	Secondary authentication and authorization revocation	173
12	Security aspects of Network Exposure Function (NEF)	173
12.1	General	173
12.2	Mutual authentication	173
12.3	Protection of the NEF – AF interface	174
12.4	Authorization of Application Function’s requests	174
12.5	Support for CAPIF	174
13	Service Based Interfaces (SBI)	174
13.1	Protection at the network or transport layer	174
13.1.0	General	174
13.1.1	TLS protection between NF and SEPP	174
13.1.1.0	General	174
13.1.1.1	TLS protection based on telescopic FQDN and wildcard certificate	175
13.1.1.2	TLS protection based on 3gpp-Sbi-Target-apiRoot HTTP header	175
13.1.2	Protection between SEPPs	176
13.2	Application layer security on the N32 interface	177
13.2.1	General	177
13.2.2	N32-c connection between SEPPs	178
13.2.2.1	General	178
13.2.2.2	Procedure for Key agreement and Parameter exchange	179
13.2.2.3	Procedure for error detection and handling in SEPP	180
13.2.2.4	N32-f Context	180
13.2.2.4.0	N32-f parts	180
13.2.2.4.1	N32-f context ID	181
13.2.2.4.2	N32-f peer information	181
13.2.2.4.3	N32-f security context	181
13.2.2.4.4	N32-f context information	181
13.2.3	Protection policies for N32 application layer solution	182
13.2.3.1	Overview of protection policies	182
13.2.3.2	Data-type encryption policy	182
13.2.3.3	NF API data-type placement mapping	182
13.2.3.4	Modification policy	183
13.2.3.5	Provisioning of the policies in the SEPP	183
13.2.3.6	Precedence of policies in the SEPP	184
13.2.4	N32-f connection between SEPPs	184
13.2.4.1	General	184
13.2.4.2	Overall Message payload structure for message reformatting at SEPP	185
13.2.4.3	Message reformatting in sending SEPP	185
13.2.4.3.1	dataToIntegrityProtect	185
13.2.4.3.1.1	clearTextEncapsulatedMessage	185
13.2.4.3.1.2	metadata	186
13.2.4.3.2	dataToIntegrityProtectAndCipher	186
13.2.4.4	Protection using JSON Web Encryption (JWE)	186
13.2.4.4.0	General	186
13.2.4.4.1	N32-f key hierarchy	186
13.2.4.5	Message modifications by roaming intermediary	188
13.2.4.5.1	modifiedDataToIntegrityProtect	188
13.2.4.5.2	Modifications by RIs	188
13.2.4.5.2a	Error messages originated  by Roaming Hub	189
13.2.4.6	Protecting RI modifications using JSON Web Signature (JWS)	189
13.2.4.7	Message verification by the receiving SEPP	189
13.2.4.8	Procedure	190
13.2.4.9	JOSE profile	193
13.3	Authentication and static authorization	193
13.3.0	Static authorization	193
13.3.1	Authentication and authorization between network functions and NRF	193
13.3.1.1	Direct communication	193
13.3.1.2	Indirect communication	193
13.3.1.3	Authorization of discovery request and error handling	194
13.3.2	Authentication between network functions	194
13.3.2.1	Direct communication	194
13.3.2.2	Indirect communication	195
13.3.2.3	Inter-PLMN NF to NF communication	195
13.3.2.4	Error handling	195
13.3.3	Authentication between SEPP and network functions	195
13.3.4	Authentication and authorization between SEPPs	195
13.3.6	Authentication and static authorization between SCP and network functions	196
13.3.7	Authentication and static authorization between SCPs	196
13.3.8	Client credentials assertion based authentication	196
13.3.8.1	General	196
13.3.8.2	Client credentials assertion	197
13.3.8.3	Verification of Client credentials assertion	197
13.4	Authorization of NF service access	197
13.4.1	OAuth 2.0 based authorization of Network Function service access	197
13.4.1.0	General	197
13.4.1.1	Service access authorization within the PLMN	198
13.4.1.1.1	OAuth 2.0 roles	198
13.4.1.1.2	Service Request Process	199
13.4.1.1.3	Access token requests in deployments with several NRFs	203
13.4.1.1A	Service access authorization in interconnect scenarios	203
13.4.1.2	Service access authorization in roaming scenarios	204
13.4.1.2.1	OAuth 2.0 roles	204
13.4.1.2.2	Service Request Process	204
13.4.1.3	Service access authorization in indirect communication scenarios	209
13.4.1.3.1	Authorization for indirect communication without delegated discovery procedure	209
13.4.1.3.1.1	With mutual authentication between NF Service Consumer and NRF at the transport layer	209
13.4.1.3.1.2	Without mutual authentication between NF and NRF at the transport layer	211
13.4.1.3.2	Authorization for indirect communication with delegated discovery procedure	212
13.4.1.4	Service access authorization in inter NF mobility scenario	213
13.4.1.5	Service access authorization in interconnect and roaming scenarios with indirect communication	213
13.4.1.5.1	General	213
13.4.1.5.2	Authorization with NF selection at source network	214
13.4.1.5.2.1	General	214
13.4.1.5.2.2	Authorization for indirect communication with or without delegated discovery procedure	214
13.4.1.5.3	Authorization with NF selection at target network	215
13.4.1.5.3.1	General	215
13.4.1.5.3.2	Authorization for indirect communication without delegated discovery procedure	215
13.4.1.5.3.3	Authorization for indirect communication with delegated discovery procedure	216
13.5	Security capability negotiation between SEPPs	217
14	Security related services	218
14.1	Services provided by AUSF	218
14.1.1	General	218
14.1.2	Nausf_UEAuthentication service	218
14.1.2.1	Nausf_UEAuthentication_Authenticate service operation	218
14.1.2.2	Nausf_UEAuthentication_deregister service operation	219
14.1.2.3	Nausf_UEAuthentication_ProseAuthenticate service operation	219
14.1.3	Nausf_SoRProtection service	219
14.1.4	Nausf_UPUProtection service	219
14.1.5	Void	220
14.2	Services provided by UDM	220
14.2.1	General	220
14.2.2	Nudm_UEAuthentication_Get service operation	220
14.2.3	Nudm_UEAuthentication_ResultConfirmation service operation	221
14.2.4	Nudm_UEAuthentication_GetProseAv service operation	221
14.2.5	Nudm_UEAuthentication_GetGbaAv service operation	221
14.2.6	Nudm_UECM_AuthTrigger service operation	221
14.2.7	Nudm_UECM_Re-AuthenticationNotification service operation	221
14.3	Services provided by NRF	221
14.3.1	General	221
14.3.2	Nnrf_AccessToken_Get Service Operation	222
14.3.3	Nnrf_AccessToken_RetrieveKey Service Operation	222
14.4	Services provided by NSSAAF	222
14.4.1	Nnssaaf_NSSAA services	222
14.4.1.1	General	222
14.4.1.2	Nnssaaf_NSSAA_Authenticate service operation	223
14.4.1.3	Nnssaaf_NSSAA_Re-AuthenticationNotification service operation	223
14.4.1.4	Nnssaaf_NSSAA_RevocationNotification service operation	223
14.4.2	Nnssaaf_AIW services	224
14.4.2.1	General	224
14.4.2.2	Nnssaaf_AIW_Authenticate service operation	224
15	Management security for network slices	224
15.1	General	224
15.2	Mutual authentication	224
15.3	Protection of management interactions between the management service consumer and the management service producer	225
15.4	Authorization of management service consumer’s request	225
16	Security procedures for network slices	225
16.1	General	225
16.2	Authorization for network slice access	225
16.3	Network slice specific authentication and authorization	226
16.4	AAA Server triggered Network Slice-Specific Re-authentication and Re-authorization procedure	228
16.5	AAA Server triggered Slice-Specific Authorization Revocation	229
16.6	AF Authorization for network slice quota-usage information notification/retrieval	230
16.6.1	Introduction	230
16.6.2	General	230
16.6.3	Subscription/unsubscription procedure of NSACF notification service	230
17	Protection of 5GC Signalling Traffic Monitoring	232
17.1	General	232
17.2	Protection for the configuration and enabling/disabling of signalling monitoring	232
17.3	Protection for the streaming of signalling monitoring data	233
18	Protection of XRM media related information	233
18.1	General	233
18.2	Protection of media related information when using connect-UDP	233
18.2.1	Using Tunnelling mode	233
18.2.2	Security of the QUIC connection between UPF and AS proxy	234
18.2.3	Using Forwarded mode	234
18.2.4	Security parameters to be used in the Forwarded mode	235
18.2.5	Key derivation in the Forwarded mode	235
18.2.6	Nonce and counter values in the Forwarded mode	235
18.2.7	VCID uniqueness in the forwarding mode	236
18.3	Protection of Media related information when using UDP Options	236
Annex A (normative):	 Key derivation functions	237
A.1	KDF interface and input parameter construction	237
A.1.1	General	237
A.1.2	FC value allocations	237
A.2	KAUSF derivation function	237
A.3	CK' and IK' derivation function	237
A.4	RES* and XRES* derivation function	238
A.5	HRES* and HXRES* derivation function	238
A.6	KSEAF derivation function	238
A.7	KAMF derivation function	239
A.7.0	Parameters for the input S to the KDF	239
A.7.1	ABBA parameter values	239
A.8	Algorithm key derivation functions	239
A.9	KgNB, KWAGF, KTNGF, KTWIF and KN3IWF derivation function	240
A.10	NH derivation function	241
A.11	KNG-RAN* derivation function for target gNB	241
A.12	KNG-RAN* derivation function for target ng-eNB	241
A.13	KAMF to KAMF'  derivation in mobility	242
A.14	KAMF to KASME' derivation for interworking	242
A.14.1	Idle mode mobility	242
A.14.2	Handover	242
A.15	KASME to KAMF' derivation for interworking	242
A.15.1	Idle mode mobility	242
A.15.2	Handover	243
A.16	Derivation of KSN for dual connectivity	243
A.17	SoR-MAC-IAUSF generation function	243
A.18	SoR-MAC-IUE/SoR-XMAC-IUE generation function	244
A.19	UPU-MAC-IAUSF generation function	244
A.20	UPU-MAC-IUE/UPU-XMAC-IUE generation function	244
A.21	KAMF to KASME_SRVCC derivation for interworking	245
A.22	KTIPSec, KTNAP and KFT derivation function	245
A.23	KIAB generation function	245
Annex B (informative):	Using additional EAP methods for primary authentication	247
B.1	Introduction	247
B.2	Primary authentication and key agreement	247
B.2.1	EAP TLS	247
B.2.1.1	Security procedures	247
B.2.1.2	Privacy considerations	251
B.2.1.2.1	EAP TLS without subscription identifier privacy	251
B.2.1.2.2	EAP TLS with subscription identifier privacy	251
B.2.2	Revocation of subscriber certificates	252
B.3	Key derivation	252
Annex C (normative):	Protection schemes for concealing the subscription permanent identifier	254
C.1	Introduction	254
C.2	Null-scheme	254
C.3	Elliptic Curve Integrated Encryption Scheme (ECIES)	255
C.3.1	General	255
C.3.2	Processing on UE side	255
C.3.3	Processing on home network side	256
C.3.4	ECIES profiles	256
C.3.4.0	General	256
C.3.4.1	Profile A	257
C.3.4.2	Profile B	257
C.4	Implementers’ test data	258
C.4.1	General	258
C.4.2	Null-scheme	258
C.4.2.1	IMSI-based SUPI	258
C.4.2.2	Network specific identifier-based SUPI	258
C.4.3	ECIES Profile A	258
C.4.3.1	IMSI-based SUPI	258
C.4.3.2	Network specific identifier-based SUPI	259
C.4.4	ECIES Profile B	260
C.4.4.1	IMSI-based SUPI	260
C.4.4.2	Network specific identifier-based SUPI	261
Annex D (normative):	Algorithms for ciphering and integrity protection	262
D.1	Null ciphering and integrity protection algorithms	262
D.2	Ciphering algorithms	262
D.2.1	128-bit Ciphering algorithms	262
D.2.1.1	Inputs and outputs	262
D.2.1.2	128-NEA1	263
D.2.1.3	128-NEA2	263
D.2.1.4	128-NEA3	263
D.3	Integrity algorithms	263
D.3.1	128-Bit integrity algorithms	263
D.3.1.1	Inputs and outputs	263
D.3.1.2	128-NIA1	264
D.3.1.3	128-NIA2	264
D.3.1.4	128-NIA3	264
D.4	Test Data for the security algorithms	264
D.4.1	General	264
D.4.2	128-NEA1	264
D.4.3	128-NIA1	264
D.4.4	128-NEA2	264
D.4.5	128-NIA2	265
D.4.6	128-NEA3	265
D.4.7	128-NIA3	265
Annex E (informative):	UE-assisted network-based detection of false base station	266
E.1	Introduction	266
E.2	Examples of using measurement reports	266
Annex F (normative):	3GPP 5G profile for EAP-AKA'	267
F.1	Introduction	267
F.2	Subscriber privacy	267
F.3	Subscriber identity and key derivation	268
F.4	Void	268
Annex G (informative):	Application layer security on the N32 interface	268
G.1	Introduction	268
G.2	Structure of HTTP Message	269
Annex H (informative):	Void	271
Annex I (normative):	Non-public networks	272
I.1	General	272
I.2	Authentication in standalone non-public networks	272
I.2.1	General	272
I.2.2	EAP framework, selection of authentication method, and EAP method credentials	272
I.2.2.1	General	272
I.2.2.2	Credentials holder using AAA server for primary authentication	273
I.2.2.2.1	General	273
I.2.2.2.2	Procedure	273
I.2.3	Key hierarchy, key derivation and key distribution	275
I.2.3.1	General	275
I.2.3.2	Credentials holder using AAA server for primary authentication	276
I.2.4	Credentials Holder using AUSF and UDM for primary authentication	276
I.3	Serving network name for standalone non-public networks	277
I.3.1	General	277
I.3.2	Definition of SN Id for standalone non-public networks	277
I.4	Modification of CAG ID list in the UE	277
I.5	SUPI privacy for standalone non-public networks	277
I.6	Authentication in Public Network Integrated Non-Public Networks (PNI-NPN)	277
I.7	Authorization aspects in SNPNs	278
I.7.1	Credentials holder using AUSF and UDM for primary authentication	278
I.8	SEPP and interconnect related security procedures	278
I.8.1	Credentials holder using AUSF and UDM for primary authentication	278
I.9	Security of UE onboarding in SNPNs	278
I.9.1	General	278
I.9.2	Authentication	278
I.9.2.1	Requirements	278
I.9.2.2	Primary authentication without using DCS	279
I.9.2.3	Primary authentication using DCS	279
I.9.2.4	Secondary authentication	279
I.9.2.4.1	Secondary authentication using DCS	279
I.9.2.4.2	Secondary authentication using DN-AAA	279
I.10	Security for access to SNPN services via Non-3GPP access	279
I.10.1	General	279
I.10.2	Security for access to SNPN services via Untrusted non-3GPP access	280
I.10.2.0	General	280
I.10.2.1	Untrusted non-3GPP access support in SNPN without CH	280
I.10.2.2	Untrusted non-3GPP access support in SNPN with CH	280
I.10.3	Security for access to SNPN services via Trusted non-3GPP access	281
I.10.3.0	General	281
I.10.3.1	Trusted non-3GPP access support in SNPN without CH	281
I.10.3.2	Trusted non-3GPP access support in SNPN with CH	281
I.10.4	Security for access to SNPN services for N5CW devices	282
I.10.4.0	General	282
I.10.4.1	Support for N5CW devices in SNPN without CH	282
I.10.4.2	Support for N5CW devices in SNPN with CH	282
I.10.5	Security for NSWO support in SNPN	283
I.10.5.1	NSWO support in SNPN using CH with AAA server	283
I.10.5.1.1	NSWO support in SNPN using CH with AAA server via AAA Proxies	283
I.10.5.1.2	NSWO support in SNPN using CH with AAA server via 5GC	284
I.10.5.2	NSWO support in SNPN without CH	284
I.10.5.3	NSWO support in SNPN using CH with AUSF/UDM	285
I.11	Security for accessing a localised service	285
Annex J (normative):	 SRVCC from 5G to UTRAN	286
J.1 	SRVCC from NR to UTRAN	286
J.1.1	General	286
J.1.2	Procedure	286
J.2	Emergency call in SRVCC from NR to UTRAN	287
J.2.1	General	287
J.2.2	Procedure	287
Annex K (normative):	Security for 5GLAN services	288
K.1	General	288
K.2	Authentication and authorization	288
K.3	Handling of UP security policy	288
Annex L (normative):	Security for TSC service	289
L.1	General	289
L.2	Access security for a 5GS TSC-enabled UE	289
L.3	Protection of user plane data in TSC including (g)PTP control messages in bridge mode	289
L.4	Exposure of time synchronisation	289
Annex M (normative):	Security for Integrated Access and Backhaul (IAB)	290
M.1	General	290
M.2	Security requirements and features	290
M.2.1	Requirements on the IAB-node (IAB-UE)	290
M.2.2	Requirements on the IAB donor	290
M.2.3	Requirements on the 5GC supporting IAB architecture	290
M.2.4	Requirements for secure environment	290
M.2.5	Requirements on the F1 interface	290
M.3	IAB-node Integration Procedure	291
M.3.1	General	291
M.3.2	Authentication and Authorization of IAB-node (Phase-1)	291
M.3.3	Security mechanisms for F1 interface between the IAB-node (gNB-DU) and the IAB-donor-CU (Phase-3)	291
M.3.3.1	General	291
M.3.3.2	Security mechanisms for the F1 interface	291
M.4	Protection of management traffic between IAB-node and OAM	292
M.5	IAB inter-CU topology adaptation and backhaul RLF recovery procedure	292
Annex N (normative):	Security for URLLC services	293
N.1	General	293
N.2	Security support on redundant transmission	293
N.2.1	Redundant user plane paths based on dual connectivity	293
N.2.1.1	Introduction	293
N.2.2.2	Security policy aspects	293
N.2.2	Redundant transmission on N3/N9 interfaces	294
Annex O (Informative):	Authentication for non-5G capable devices behind residential gateways	295
O.1	General	295
O.2	Baseline for using non-5G capable devices with 5GC	295
O.3	Authentication procedure	295
Annex P (informative):	Security Aspects of DNS and ICMP	300
P.1	General	300
P.2	Security aspects of DNS	300
P.3	Security aspects of ICMP	300
Annex Q (normative):	Security and privacy in 5G system location services	300
Q.1	General	300
Q.2	Security in 5G system location services to support user plane positioning	301
Annex R (informative):	Authorization aspects in communication models for NF/NF services interaction	302
Annex S (normative):	 Support for Non-seamless WLAN offload (NSWO) in 5GS	304
S.1	Introduction	304
S.2	General	304
S.3	Authentication procedure	304
S.3.1	5G NSWO co-existence with EPS NSWO	304
S.3.2	5G NSWO procedures	305
S.4	Roaming	306
Annex T (normative):	Security for edge computing	307
T.1	General	307
T.2	Security of network exposure to edge application server	307
T.3	Security of EAS discovery procedure via EASDF in non-roaming Scenario	307
T.4	Security of EAS discovery procedure via V-EASDF in roaming Scenario	307
T.5	Security of N6 delay measurements	308
Annex U (informative):	 Primary authentication using EAP-TTLS in SNPNs	309
U.1	Introduction	309
U.2	Procedure	309
Annex V (normative):	 User consent requirements and mechanisms	312
V.1	General	312
V.1.1	Scope	312
V.1.2	Relationship between end-users and subscriber	312
V.2	Requirements	312
V.3	User consent check	312
V.4	User consent revocation	313
Annex W (normative):	 Security for multicast/broadcast service for 3GPP service	314
W.1	General	314
W.2	Security requirements	314
W.2.1	Requirements of MBSF	314
W.2.2	Requirements of MBSTF	314
W.3	Security mechanisms for xMB-C/MB2-C and xMB-U/MB2-U interface	314
W.4	Security mechanisms for MBS traffic transmission	314
W.4.1	Key derivation, management and distribution	314
W.4.1.1	General	314
W.4.1.2	Control-plane procedure	314
W.4.1.3	User-plane procedure	315
W.4.2	Protection of the traffic transmission	316
W.4.3	Authentication and authorization aspects for the multicast session	316
W.4.4	Security handling in network sharing scenario	316
W.5	Security protection for interworking between 5MBS and eMBMS	317
Annex X (normative):	Security aspects of enablers for Network Automation (eNA) for the 5G system (5GS)	318
X.1	General	318
X.7	User consent requirements	323
X.8	Protection of data and analytics exchange in roaming case	324
X.8.1	General	324
X.8.2	Procedure for protection of analytics exchange in roaming case	325
X.8.2.1	Policies configured locally in Roaming entry NWDAF producer	325
X.8.2.2	Policies configured as extended claims in access token	326
X.9	Authorization of selection of participant NWDAF instances in the Federated Learning group	327
X.10	Security for AI/ML model storage and sharing	328
X.11	Security for UE positioning based on a ML model at the LMF	332
X.11.1	General	332
X.11.2	Security for data collection for the LMF-based AI/ML positioning	332
X.11.3	Authorization of LMF retrieval of a trained AI/ML model for positioning	332
X.12	Security for Vertical Federated Learning among NWDAFs and AFs	332
X.12.1	General	332
X.12.2	Authorization of candidate VFL participants	333
X.12.2.1	Authorization of candidate VFL participants for VFL when NWDAF or Internal AF is acting as the VFL server	333
X.12.2.2	Authorization of candidate VFL participants for vertical federated learning when external AF is acting as the VFL server	334
X.12.3	NEF security requirements	336
X.12.4	Protection of communication data used in VFL process.	336
Annex Y (normative):	 Security aspects of the Message Service for MIoT over the 5G System (MSGin5G)	337
Y.1	General	337
Y.2	Authentication and authorization between MSGin5G client and MSGin5G server	337
Y.3	Transport security protection for MSGin5G interfaces	337
Y.4	Authentication and authorization between application server and MSGin5G server	338
Y.5	Authentication and authorization between message Gateway and MSGin5G server	338
Y.6	Authentication and authorization in bulk registration scenarios	338
Annex Z (normative):	 Authentication of AUN3 devices using additional EAP methods	339
Z.1	 General	339
Z.2	Authentication of AUN3 devices by 5GC	339
Z.3	Authentication of AUN3 devices by AAA server	340
Annex AA (normative):	 Security aspects of the Access Traffic Steering, Switching and Splitting (ATSSS)	341
AA.1	General	341
AA.2	Server authentication for MPQUIC in ATSSS	341
Annex AB (Informative):	Security for PLMN hosting a NPN through SBA interface	342
AB.1	General	342
AB.2	Architecture	342
AB.3	Proxy entity at the border	343
AB.4	Policy Check	343
AB.5	Security for DNS messages crossing the border	343
Annex AC (informative):	Change history	345
